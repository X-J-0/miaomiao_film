{"remainingRequest":"C:\\Users\\86183\\Desktop\\notebook\\vue练习\\miaomiao\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\86183\\Desktop\\notebook\\vue练习\\miaomiao\\src\\components\\City\\index.vue?vue&type=style&index=0&id=679f5e5e&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\86183\\Desktop\\notebook\\vue练习\\miaomiao\\src\\components\\City\\index.vue","mtime":1585550193492},{"path":"C:\\Users\\86183\\Desktop\\notebook\\vue练习\\miaomiao\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86183\\Desktop\\notebook\\vue练习\\miaomiao\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\86183\\Desktop\\notebook\\vue练习\\miaomiao\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\86183\\Desktop\\notebook\\vue练习\\miaomiao\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86183\\Desktop\\notebook\\vue练习\\miaomiao\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQojY29udGVudCAuY2l0eV9ib2R5e21hcmdpbi10b3A6NDVweDtkaXNwbGF5OmZsZXg7d2lkdGg6MTAwJTtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3R0b206MDt9DQouY2l0eV9ib2R5IC5jaXR5X2xpc3R7ZmxleDoxO292ZXJmbG93OmF1dG87YmFja2dyb3VuZC1jb2xvcjogI2ZmZjt9DQouY2l0eV9ib2R5IC5jaXR5X2xpc3Q6OndlYmtpdF9zY3JvbGxiYXJ7DQogIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50Ow0KICB3aWR0aDowOw0KfQ0KLmNpdHlfYm9keSAuY2l0eV9ob3R7bWFyZ2luLXRvcDoyMHB4O30NCi5jaXR5X2JvZHkgLmNpdHlfaG90IGgye3BhZGRpbmctbGVmdDoxNXB4O2xpbmUtaGVpZ2h0OiAzMHB4O2ZvbnQtc2l6ZToxNHB4O2JhY2tncm91bmQtY29sb3I6ICNmZmY7Zm9udC13ZWlnaHQ6IG5vcm1hbDt9DQovKiAuY2l0eV9ib2R5IC5jaXR5X2hvdCB1bHt9ICovDQouY2l0eV9ib2R5IC5jaXR5X2hvdCB1bCBsaXtmbG9hdDpsZWZ0O2JhY2tncm91bmQtY29sb3I6ICNmZmY7d2lkdGg6MjklO2hlaWdodDozM3B4O21hcmdpbi10b3A6MTVweDttYXJnaW4tbGVmdDozJTtwYWRkaW5nOjAgNHB4O2JvcmRlcjoxcHggc29saWQgI2U2ZTZlNn0NCi8qIC5jaXR5X2JvZHkgLmNpdHlfc29ydHt9ICovDQouY2l0eV9ib2R5IC5jaXR5X3NvcnQgZGl2e21hcmdpbi10b3A6MjBweDt9DQouY2l0eV9ib2R5IC5jaXR5X3NvcnQgaDJ7cGFkZGluZy1sZWZ0OjE1cHg7bGluZS1oZWlnaHQ6IDMwcHg7Zm9udC1zaXplOjE0cHg7YmFja2dyb3VuZC1jb2xvcjogI2ZmZjtmb250LXdlaWdodDogbm9ybWFsO30NCi5jaXR5X2JvZHkgLmNpdHlfc29ydCB1bHtwYWRkaW5nLWxlZnQ6MTBweDttYXJnaW4tdG9wOjEwcHg7fQ0KLmNpdHlfYm9keSAuY2l0eV9zb3J0IHVsIGxpe2xpbmUtaGVpZ2h0OiAzMHB4O2xpbmUtaGVpZ2h0OiAzMHB4O30NCi5jaXR5X2JvZHkgLmNpdHlfaW5kZXh7d2lkdGg6MjBweDtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246IGNvbHVtbjtqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjt0ZXh0LWFsaWduOiBjZW50ZXI7Ym9yZGVyLWxlZnQ6MXB4ICNlNmU2ZTYgc29saWR9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/City","sourcesContent":["<template>\r\n  <div class=\"city_body\">\r\n    <!-- <div class=\"city_list\">\r\n      <div class=\"city_hot\">\r\n        <h2>热门城市</h2>\r\n        <ul class=\"clearfix\">\r\n          <li>上海</li>\r\n        </ul>\r\n      </div>\r\n      <div class=\"city_sort\">\r\n        <div>\r\n          <h2>A</h2>\r\n          <ul>\r\n            <li>阿拉善盟</li>\r\n            <li>鞍山</li>\r\n            <li>安庆</li>\r\n            <li>安阳</li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"city_index\">\r\n      <ul>\r\n        <li>A</li>\r\n        <li>B</li>\r\n        <li>C</li>\r\n        <li>D</li>\r\n        <li>E</li>\r\n      </ul>\r\n    </div> -->\r\n    <div class=\"city_list\">\r\n      <Loading v-if=\"isLoading\"/>\r\n        <div v-else class=\"city_hot\">\r\n        <h2>热门城市</h2>\r\n        <ul class=\"clearfix\">\r\n          <li v-for=\"item in hotList\" :key=\"item.id\" @click=\"handleToCity(item.nm,item.id)\">{{item.nm}}</li>\r\n        </ul>\r\n      </div>\r\n      <div class=\"city_sort\" ref=\"city_sort\">\r\n        <div v-for=\"item in cityList\" :key=\"item.index\">\r\n          <h2>{{item.index}}</h2>\r\n          <ul>\r\n            <li v-for=\"itemList in item.list\" :key=\"itemList.id\" @click=\"handleToCity(itemList.nm,itemList.id)\">{{itemList.nm}}</li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"city_index\">\r\n      <ul>\r\n        <li v-for=\"(item, index) in cityList\" :key=\"item.index\" @touchstart=\"handleToIndex(index)\">{{item.index}}</li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name:'City',\r\n  data(){\r\n    return {\r\n      cityList:[],\r\n      hotList:[],\r\n      isLoading:true\r\n    }\r\n  },\r\n  mounted () {\r\n    var cityList = window.localStorage.getItem('cityList');\r\n    var hotList = window.localStorage.getItem('hotList');\r\n    if(cityList && hotList){\r\n      this.cityList = JSON.parse(cityList);\r\n      this.hotList = JSON.parse(hotList);\r\n      this.isLoading=false;\r\n    }\r\n    this.axios.get('/api/cityList').then((res) => {\r\n      var msg = res.data.msg;\r\n      if(msg == 'ok') {\r\n        this.isLoading=false;\r\n        var cities = res.data.data.cities;\r\n        var {cityList,hotList} = this.formatCityList(cities);\r\n        this.cityList = cityList;\r\n        this.hotList = hotList;\r\n        window.localStorage.setItem('cityList',JSON.stringify(cityList));\r\n        window.localStorage.setItem('hotList',JSON.stringify(hotList));\r\n      }\r\n    })\r\n  },\r\n  methods:{\r\n    formatCityList(cities){\r\n      var cityList = [];\r\n      var hotList = [];\r\n      for(var i = 0;i<cities.length;i++){\r\n        if(cities[i].isHot === 1){\r\n          hotList.push(cities[i]);\r\n        }\r\n      }\r\n      for(var i = 0;i<cities.length;i++){\r\n        var firstLetter = cities[i].py.substring(0,1).toUpperCase();\r\n        if(toCom(firstLetter)){  //新添加index\r\n          cityList.push({index:firstLetter,list:[{nm:cities[i].nm,id:cities[i].id}]});\r\n        }\r\n        else{  //累加到已有index中\r\n          for(var j = 0;j<cityList.length;j++){\r\n            if(cityList[j].index === firstLetter){\r\n              cityList[j].list.push({nm:cities[i].nm,id:cities[i].id});\r\n            }\r\n          }\r\n        }\r\n      }\r\n      cityList.sort((n1,n2)=>{\r\n        if(n1.index>n2.index){\r\n          return 1;\r\n        }\r\n        else if(n1.index<n2.index){\r\n          return -1;\r\n        }\r\n        else{\r\n          return 0;\r\n        }\r\n      });\r\n      function toCom(firstLetter){\r\n        for(var i = 0;i<cityList.length;i++){\r\n          if(cityList[i].index == firstLetter){\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n      return {\r\n        cityList,\r\n        hotList\r\n      }\r\n    },\r\n    handleToIndex(index){\r\n      var h2 = this.$refs.city_sort.getElementsByTagName('h2');\r\n      this.$refs.city_sort.parentNode.scrollTop = h2[index].offsetTop;\r\n    },\r\n    handleToCity(nm,id){\r\n      this.$store.commit('city/CITY_INFO',{nm,id});\r\n      this.$router.push('/movie/nowPlaying');\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#content .city_body{margin-top:45px;display:flex;width:100%;position:absolute;top:0;bottom:0;}\r\n.city_body .city_list{flex:1;overflow:auto;background-color: #fff;}\r\n.city_body .city_list::webkit_scrollbar{\r\n  background-color: transparent;\r\n  width:0;\r\n}\r\n.city_body .city_hot{margin-top:20px;}\r\n.city_body .city_hot h2{padding-left:15px;line-height: 30px;font-size:14px;background-color: #fff;font-weight: normal;}\r\n/* .city_body .city_hot ul{} */\r\n.city_body .city_hot ul li{float:left;background-color: #fff;width:29%;height:33px;margin-top:15px;margin-left:3%;padding:0 4px;border:1px solid #e6e6e6}\r\n/* .city_body .city_sort{} */\r\n.city_body .city_sort div{margin-top:20px;}\r\n.city_body .city_sort h2{padding-left:15px;line-height: 30px;font-size:14px;background-color: #fff;font-weight: normal;}\r\n.city_body .city_sort ul{padding-left:10px;margin-top:10px;}\r\n.city_body .city_sort ul li{line-height: 30px;line-height: 30px;}\r\n.city_body .city_index{width:20px;display:flex;flex-direction: column;justify-content: center;text-align: center;border-left:1px #e6e6e6 solid}\r\n</style>\r\n"]}]}